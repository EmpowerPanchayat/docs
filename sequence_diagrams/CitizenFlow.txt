title E-Gram Sabha : Citizen Flow

participant Citizen
participant Admin
participant Official
participant Frontend
participant Backend
participant MongoDB
participant CronJob
participant VideoMomBackend
participant HuggingFaceLLM
participant JioTranslate
participant JioSign
participant JioMeet

== Citizen Flow ==

Citizen->Frontend: Login (with Face Recognition)
Frontend->Backend: POST api/auth/citizen/face-login/verify (face data)
Backend->MongoDB: Fetch face data
MongoDB-->Backend: Recognition result
Backend-->Backend: Verify security token(s) and compare face
Backend-->Frontend: Auth token+data / error
Frontend-->Citizen: Show home page or error

Citizen->Frontend: View List of issues/suggestions
Frontend->Backend: GET /api/issues
Backend->MongoDB: Fetch issues based on query params like panchayatId
MongoDB-->Backend: Issues data
Backend-->Frontend: Issues data
Frontend-->Citizen: Show my/all issues

Citizen->Frontend: View any Past meeting details
Frontend->Backend: GET /api/gram-sabha/{gramSabhaId}, rsvp, attendance, stats
Backend->MongoDB: Fetch data
MongoDB-->Backend: Gram sabha details
Backend-->Frontend: Gram sabha details
Frontend-->Citizen: Selected Past Gram sabha details

Citizen->Frontend: View Upcoming meeting details
Frontend->Backend: GET /api/gram-sabha/{gramSabhaId}, rsvp, attendance, stats
Backend->MongoDB: Fetch data
MongoDB-->Backend: Gram sabha details
Backend-->Frontend: Gram sabha details
Frontend-->Citizen: Selected Gram sabha details

Citizen->Frontend: RSVP to Meeting
Frontend->Backend: POST /api/gram-sabha/{gramSavhaId}/rsvp/{Id}
Backend->MongoDB: Update RSVP
MongoDB-->Backend: RSVP status
Backend-->Frontend: RSVP confirmation
Frontend-->Citizen: Show RSVP status

Citizen->Frontend: Logout
Frontend-->Citizen: Navigate to home page

== Citizen Issue Reporting with Transcription & Jio Translate ==

Citizen->Frontend: Submit Issue (in local language)
Frontend->Backend: POST /api/issues (issueData)
Backend-->Backend: Validate required fields
Backend->MongoDB: Find Panchayat by panchayatId
Backend->MongoDB: Find creator and createdFor users
Backend->MongoDB: Insert issue document
MongoDB-->Backend: Issue saved (issueId)
Backend-->Frontend: Success, return issueId
 Frontend->Backend: POST /api/issues/upload-attachment (issueId, audio)
Backend->VideoMomBackend: Transcribe & translate audio
VideoMomBackend->MongoDB: Saves final, enhanced, multi-lingual results for the request_id
MongoDB-->Backend: Issue updated
Backend-->Frontend: Success
Frontend-->Citizen: Show success message, reset form, redirect after delay